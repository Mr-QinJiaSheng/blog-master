+function(t){"use strict";var e="ontouchstart"in document?"touchstart":"click",a={queue:[],current:null,bomb:0,debug:!1},n=function(t){a.debug&&console.log(t)},r=function(t){if(!isFinite(t)||0>t)t="--:--";else{var e=Math.floor(t/60);t=Math.floor(t)%60,t=(10>e?"0"+e:e)+":"+(10>t?"0"+t:t)}return t},s=function(){var r=this;this.options={selector:"#nm_jplayer"},this.player=this.options.selector,r._init(),t(r.player).bind(t.jPlayer.event.play,function(){var e=playlist[a.current][a.bomb];t(".nms-play-btn").removeClass("nm-pause").addClass("nm-play"),t(".nms-list-item").removeClass("is-active"),t("#nm-list-"+a.current+" .nms-list-item").data("status","ready"),t("#nm-player-"+a.current+" .nmplayer-title").html(e.title+" - "+e.artist),t("#nm-player-"+a.current+" .duration").html("--:--"),t("#nm-player-"+a.current+" .nms-play-btn").removeClass("nm-play").addClass("nm-pause"),t("#nm-list-"+a.current).length>0&&(t("#nm-list-"+a.current+" .nms-list-item").eq(a.bomb).addClass("is-active"),t("#nm-list-"+a.current+" .nms-list-item").eq(a.bomb).data("status","play"))}),t(r.player).bind(t.jPlayer.event.pause,function(){playlist[a.current][a.bomb];t("#nm-player-"+a.current+" .nms-play-btn").removeClass("nm-pause").addClass("nm-play"),t("#nm-list-"+a.current+" .nms-list-item").eq(a.bomb).data("status","pause"),n(a.bomb),n("sb")}),t(r.player).bind(t.jPlayer.event.ended,function(){a.bomb<playlist[a.current].length-1?(a.bomb=a.bomb+1,r.play(a.current,a.bomb),t(r.player).jPlayer("play"),n("continue")):(a.bomb=0,n("end success"))}),t(r.player).bind(t.jPlayer.event.error,function(){a.bomb<playlist[a.current].length-1?(a.bomb=a.bomb+1,r.play(a.current,a.bomb),t(r.player).jPlayer("play"),n("continue")):(a.bomb=0,n("end success"))}),t(document).on(e,".com-close",function(){var e=t(this);e.parent().remove()}),t(document).on(e,".nm-mute",function(){var e=t(".nm-mute"),a=e.data("status");"mute"==a?(t(r.player).jPlayer("unmute"),e.data("status","unmute"),e.removeClass("muted"),n("unmute mod")):(e.data("status","mute"),t(r.player).jPlayer("mute"),e.addClass("muted"),n("mute mod"))}),t(document).on(e,".nm-previous",function(){var e=t(this),s=e.parent().data("index");n("previous"),s==a.current&&(playlist[a.current]<2||(n("previous"),r.previous()))}),t(document).on(e,".list-triggle",function(){console.log("sb");var e=t(this),a=e.parent().data("index"),n=t("#nm-list-"+a);n.hasClass("hide")?(e.html("隐藏列表"),n.removeClass("hide")):(e.html("展开列表"),n.addClass("hide"))}),t(document).on(e,".nm-next",function(){var e=t(this),s=e.parent().data("index");n("next"),s==a.current&&(n("next"),r.next())}),t(document).on(e,".nms-play-btn",function(){var e=t(this),s=e.data("index");a.current==s?e.hasClass("nm-play")?(n("player continue."),r.play()):(n("player pause."),r.pause()):(n("player play."),a.current=s,r.play(a.current,0))}),t(".nmsingle-process").on("click",function(e){e.preventDefault();var n=t(this),s=n.data("index");if(s===a.current){var l=n.offset().left,i=(e.pageX-l)/n.width(),u=playlist[a.current][a.bomb].duration;t(r.player).jPlayer("play",u*i)}}),t(document).on("click",".nms-list-item",function(){var e=t(this),r=e.parent().data("index"),s=e.index();return r==a.current&&s==a.bomb?n("current song selected"):(a.current=r,a.bomb=s,t("#nm_jplayer").jPlayer("setMedia",playlist[a.current][a.bomb]),void t("#nm_jplayer").jPlayer("play"))})};s.prototype={_init:function(){t(this.player).jPlayer({timeupdate:function(e){var n,n=e.jPlayer.status.currentTime,n=r(n),s=playlist[a.current][a.bomb].lrc,l=parseInt(e.jPlayer.status.currentTime);void 0!=s[l]&&t("#nm-player-"+a.current+" .nmsingle-lrc").html(s[l]),t("#nm-player-"+a.current+" .current-time").text(n),t("#nm-player-"+a.current+" .duration").text(r(e.jPlayer.status.duration)),t("#nm-player-"+a.current+" .nmsingle-process-bar").css("transform","translateX("+(e.jPlayer.status.currentPercentAbsolute-100)+"%)")},supplied:"mp3",swfPath:nm_ajax_url.swfurl,solution:"html,flash",volume:1})},play:function(e,a){"undefined"!=typeof e&&"undefined"!=typeof a&&this.select(e,a),t(this.player).jPlayer("play")},pause:function(){t(this.player).jPlayer("pause")},next:function(){var t=playlist[a.current].length;a.bomb!=t-1&&this.play(a.current,a.bomb+1)},previous:function(){a.bomb<1||(n(a.bomb),this.play(a.current,a.bomb-1))},select:function(e,n){a.current=e,a.bomb=n,t(this.player).jPlayer("setMedia",playlist[a.current][a.bomb])}};new s}(jQuery);